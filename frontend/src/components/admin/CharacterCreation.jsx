import React, { useState, useEffect } from 'react'\nimport { motion } from 'framer-motion'\nimport { Plus, X, Save, Upload, Calendar, MapPin, Book, Award, Quote, Clock } from 'lucide-react'\n\nconst CharacterCreation = ({ onCharacterCreated, user }) => {\n  const [formData, setFormData] = useState({\n    name: '',\n    arabic_name: '',\n    english_name: '',\n    title: '',\n    description: '',\n    category: 'الصحابة',\n    era: 'الخلافة الراشدة',\n    birth_year: '',\n    death_year: '',\n    birth_place: '',\n    death_place: '',\n    full_story: '',\n    key_achievements: [],\n    lessons: [],\n    quotes: [],\n    timeline_events: [],\n    profile_image: ''\n  })\n  \n  const [loading, setLoading] = useState(false)\n  const [error, setError] = useState('')\n  const [success, setSuccess] = useState('')\n  \n  const categories = [\n    'الأنبياء',\n    'الصحابة',\n    'التابعون',\n    'العلماء',\n    'النساء الصالحات',\n    'القادة',\n    'الفقهاء'\n  ]\n  \n  const eras = [\n    'ما قبل الإسلام',\n    'العصر النبوي',\n    'الخلافة الراشدة',\n    'الدولة الأموية',\n    'الدولة العباسية',\n    'الدولة العثمانية',\n    'العصر الحديث'\n  ]\n  \n  const handleInputChange = (e) => {\n    const { name, value } = e.target\n    setFormData(prev => ({\n      ...prev,\n      [name]: value\n    }))\n  }\n  \n  const handleArrayInput = (field, value) => {\n    const items = value.split(',').map(item => item.trim()).filter(item => item)\n    setFormData(prev => ({\n      ...prev,\n      [field]: items\n    }))\n  }\n  \n  const addTimelineEvent = () => {\n    setFormData(prev => ({\n      ...prev,\n      timeline_events: [...prev.timeline_events, { year: '', title: '', description: '' }]\n    }))\n  }\n  \n  const updateTimelineEvent = (index, field, value) => {\n    setFormData(prev => ({\n      ...prev,\n      timeline_events: prev.timeline_events.map((event, i) => \n        i === index ? { ...event, [field]: value } : event\n      )\n    }))\n  }\n  \n  const removeTimelineEvent = (index) => {\n    setFormData(prev => ({\n      ...prev,\n      timeline_events: prev.timeline_events.filter((_, i) => i !== index)\n    }))\n  }\n  \n  const handleSubmit = async (e) => {\n    e.preventDefault()\n    setLoading(true)\n    setError('')\n    setSuccess('')\n    \n    try {\n      const token = localStorage.getItem('access_token')\n      const response = await fetch('http://localhost:8000/api/admin/characters', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${token}`\n        },\n        body: JSON.stringify(formData)\n      })\n      \n      if (response.ok) {\n        const result = await response.json()\n        setSuccess('Character created successfully and submitted for approval!')\n        setFormData({\n          name: '',\n          arabic_name: '',\n          english_name: '',\n          title: '',\n          description: '',\n          category: 'الصحابة',\n          era: 'الخلافة الراشدة',\n          birth_year: '',\n          death_year: '',\n          birth_place: '',\n          death_place: '',\n          full_story: '',\n          key_achievements: [],\n          lessons: [],\n          quotes: [],\n          timeline_events: [],\n          profile_image: ''\n        })\n        \n        if (onCharacterCreated) {\n          onCharacterCreated(result)\n        }\n      } else {\n        const errorData = await response.json()\n        setError(errorData.detail || 'Failed to create character')\n      }\n    } catch (err) {\n      setError('Network error. Please try again.')\n    } finally {\n      setLoading(false)\n    }\n  }\n  \n  return (\n    <motion.div\n      initial={{ opacity: 0, y: 20 }}\n      animate={{ opacity: 1, y: 0 }}\n      className=\"bg-white rounded-xl shadow-lg p-6\"\n    >\n      <div className=\"mb-6\">\n        <h2 className=\"text-2xl font-bold text-gray-900 mb-2\">Create New Character</h2>\n        <p className=\"text-gray-600\">Add a new Islamic character to the platform. All submissions require approval.</p>\n      </div>\n      \n      {error && (\n        <div className=\"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg text-red-700\">\n          {error}\n        </div>\n      )}\n      \n      {success && (\n        <div className=\"mb-4 p-4 bg-green-50 border border-green-200 rounded-lg text-green-700\">\n          {success}\n        </div>\n      )}\n      \n      <form onSubmit={handleSubmit} className=\"space-y-6\">\n        {/* Basic Information */}\n        <div className=\"border-b border-gray-200 pb-6\">\n          <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Basic Information</h3>\n          \n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                Name *\n              </label>\n              <input\n                type=\"text\"\n                name=\"name\"\n                value={formData.name}\n                onChange={handleInputChange}\n                required\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                placeholder=\"Character name\"\n              />\n            </div>\n            \n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                Arabic Name\n              </label>\n              <input\n                type=\"text\"\n                name=\"arabic_name\"\n                value={formData.arabic_name}\n                onChange={handleInputChange}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                placeholder=\"الاسم بالعربية\"\n              />\n            </div>\n            \n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                English Name\n              </label>\n              <input\n                type=\"text\"\n                name=\"english_name\"\n                value={formData.english_name}\n                onChange={handleInputChange}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                placeholder=\"English name\"\n              />\n            </div>\n            \n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                Title\n              </label>\n              <input\n                type=\"text\"\n                name=\"title\"\n                value={formData.title}\n                onChange={handleInputChange}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                placeholder=\"Historical title\"\n              />\n            </div>\n          </div>\n          \n          <div className=\"mt-4\">\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Description *\n            </label>\n            <textarea\n              name=\"description\"\n              value={formData.description}\n              onChange={handleInputChange}\n              required\n              rows={3}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              placeholder=\"Brief description of the character\"\n            />\n          </div>\n          \n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4\">\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                Category\n              </label>\n              <select\n                name=\"category\"\n                value={formData.category}\n                onChange={handleInputChange}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              >\n                {categories.map(category => (\n                  <option key={category} value={category}>{category}</option>\n                ))}\n              </select>\n            </div>\n            \n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                Era\n              </label>\n              <select\n                name=\"era\"\n                value={formData.era}\n                onChange={handleInputChange}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              >\n                {eras.map(era => (\n                  <option key={era} value={era}>{era}</option>\n                ))}\n              </select>\n            </div>\n          </div>\n        </div>\n        \n        {/* Life Details */}\n        <div className=\"border-b border-gray-200 pb-6\">\n          <h3 className=\"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2\">\n            <Calendar className=\"text-blue-600\" size={20} />\n            Life Details\n          </h3>\n          \n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                Birth Year\n              </label>\n              <input\n                type=\"number\"\n                name=\"birth_year\"\n                value={formData.birth_year}\n                onChange={handleInputChange}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                placeholder=\"573\"\n              />\n            </div>\n            \n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                Death Year\n              </label>\n              <input\n                type=\"number\"\n                name=\"death_year\"\n                value={formData.death_year}\n                onChange={handleInputChange}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                placeholder=\"634\"\n              />\n            </div>\n            \n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                Birth Place\n              </label>\n              <input\n                type=\"text\"\n                name=\"birth_place\"\n                value={formData.birth_place}\n                onChange={handleInputChange}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                placeholder=\"Mecca\"\n              />\n            </div>\n            \n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                Death Place\n              </label>\n              <input\n                type=\"text\"\n                name=\"death_place\"\n                value={formData.death_place}\n                onChange={handleInputChange}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                placeholder=\"Medina\"\n              />\n            </div>\n          </div>\n        </div>\n        \n        {/* Full Story */}\n        <div className=\"border-b border-gray-200 pb-6\">\n          <h3 className=\"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2\">\n            <Book className=\"text-blue-600\" size={20} />\n            Full Story\n          </h3>\n          <textarea\n            name=\"full_story\"\n            value={formData.full_story}\n            onChange={handleInputChange}\n            rows={6}\n            className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            placeholder=\"Complete biographical narrative of the character...\"\n          />\n        </div>\n        \n        {/* Achievements & Lessons */}\n        <div className=\"border-b border-gray-200 pb-6\">\n          <h3 className=\"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2\">\n            <Award className=\"text-blue-600\" size={20} />\n            Achievements & Lessons\n          </h3>\n          \n          <div className=\"space-y-4\">\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                Key Achievements (comma-separated)\n              </label>\n              <input\n                type=\"text\"\n                value={formData.key_achievements.join(', ')}\n                onChange={(e) => handleArrayInput('key_achievements', e.target.value)}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                placeholder=\"First Caliph of Islam, Preserved the Quran, Conquered Persia\"\n              />\n            </div>\n            \n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                Lessons (comma-separated)\n              </label>\n              <input\n                type=\"text\"\n                value={formData.lessons.join(', ')}\n                onChange={(e) => handleArrayInput('lessons', e.target.value)}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                placeholder=\"Loyalty to the truth, Sacrifice for the community, Wisdom in leadership\"\n              />\n            </div>\n            \n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                Quotes (comma-separated)\n              </label>\n              <input\n                type=\"text\"\n                value={formData.quotes.join(', ')}\n                onChange={(e) => handleArrayInput('quotes', e.target.value)}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                placeholder=\"I have not given up any good thing except that I have replaced it with something better\"\n              />\n            </div>\n          </div>\n        </div>\n        \n        {/* Timeline Events */}\n        <div className=\"border-b border-gray-200 pb-6\">\n          <h3 className=\"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2\">\n            <Clock className=\"text-blue-600\" size={20} />\n            Timeline Events\n          </h3>\n          \n          <div className=\"space-y-4\">\n            {formData.timeline_events.map((event, index) => (\n              <div key={index} className=\"flex gap-4 items-start\">\n                <input\n                  type=\"number\"\n                  value={event.year}\n                  onChange={(e) => updateTimelineEvent(index, 'year', e.target.value)}\n                  className=\"w-24 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                  placeholder=\"Year\"\n                />\n                <input\n                  type=\"text\"\n                  value={event.title}\n                  onChange={(e) => updateTimelineEvent(index, 'title', e.target.value)}\n                  className=\"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                  placeholder=\"Event title\"\n                />\n                <input\n                  type=\"text\"\n                  value={event.description}\n                  onChange={(e) => updateTimelineEvent(index, 'description', e.target.value)}\n                  className=\"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                  placeholder=\"Event description\"\n                />\n                <button\n                  type=\"button\"\n                  onClick={() => removeTimelineEvent(index)}\n                  className=\"p-2 text-red-600 hover:bg-red-50 rounded-lg\"\n                >\n                  <X size={20} />\n                </button>\n              </div>\n            ))}\n            \n            <button\n              type=\"button\"\n              onClick={addTimelineEvent}\n              className=\"flex items-center gap-2 px-4 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200\"\n            >\n              <Plus size={20} />\n              Add Timeline Event\n            </button>\n          </div>\n        </div>\n        \n        {/* Profile Image */}\n        <div>\n          <h3 className=\"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2\">\n            <Upload className=\"text-blue-600\" size={20} />\n            Profile Image\n          </h3>\n          <input\n            type=\"url\"\n            name=\"profile_image\"\n            value={formData.profile_image}\n            onChange={handleInputChange}\n            className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            placeholder=\"https://example.com/image.jpg\"\n          />\n        </div>\n        \n        {/* Submit Button */}\n        <div className=\"flex justify-end\">\n          <button\n            type=\"submit\"\n            disabled={loading}\n            className=\"flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed\"\n          >\n            {loading ? (\n              <>\n                <div className=\"animate-spin rounded-full h-5 w-5 border-b-2 border-white\"></div>\n                Creating...\n              </>\n            ) : (\n              <>\n                <Save size={20} />\n                Create Character\n              </>\n            )}\n          </button>\n        </div>\n      </form>\n    </motion.div>\n  )\n}\n\nexport default CharacterCreation
